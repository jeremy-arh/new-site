<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- PRECONNECT CRITIQUES - TOUT EN HAUT pour max efficacité -->
    <link rel="preconnect" href="https://imagedelivery.net" crossorigin />
    <link rel="preconnect" href="https://jlizwheftlnhoifbqeex.supabase.co" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://api.iconify.design" crossorigin />
    <link rel="dns-prefetch" href="https://plausible.io" />
    <link rel="dns-prefetch" href="https://client.crisp.chat" />
    
    <link rel="icon" type="image/svg+xml" href="/src/assets/favicon.svg" />
    <link rel="apple-touch-icon" href="/src/assets/favicon.svg" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="theme-color" content="#000000" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <title>My notary - Notarize and Apostille Your Documents 100% Online</title>
    <meta name="description" content="Notarize and apostille your documents 100% online. Secure, legally valid, and recognized internationally through the Hague Convention. Book your appointment in minutes." />
    <meta name="author" content="My Notary" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="My notary - Notarize and Apostille Your Documents 100% Online" />
    <meta property="og:description" content="Notarize and apostille your documents 100% online. Secure, legally valid, and recognized internationally through the Hague Convention." />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="My notary - Notarize and Apostille Your Documents 100% Online" />
    <meta name="twitter:description" content="Notarize and apostille your documents 100% online. Secure, legally valid, and recognized internationally through the Hague Convention." />

    <!-- Preload LCP image - HAUTE PRIORITÉ (desktop + mobile) - DOIT correspondre à Hero.jsx -->
    <link rel="preload" as="image" href="https://imagedelivery.net/l2xsuW0n52LVdJ7j0fQ5lA/d0f6bfc4-a8db-41e1-87e2-7c7e0b7a1c00/q=20,f=webp" fetchpriority="high" media="(min-width: 769px)">
    <link rel="preload" as="image" href="https://imagedelivery.net/l2xsuW0n52LVdJ7j0fQ5lA/d0f6bfc4-a8db-41e1-87e2-7c7e0b7a1c00/w=800,q=20,f=webp" fetchpriority="high" media="(max-width: 768px)">

    <!-- Google Fonts - display=optional évite les layout shifts -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Geist:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=optional" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Geist:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=optional"></noscript>
    
    <!-- Fallback fonts inline -->
    <style>
      body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif; }
      h1, h2 { font-family: Georgia, 'Times New Roman', serif; }
    </style>
    
    <!-- Google Tag Manager - Chargé UNIQUEMENT après interaction utilisateur pour optimiser les performances -->
    <!-- GTM chargera automatiquement gtag.js et autres scripts via son conteneur -->
    <script>
      window.dataLayer = window.dataLayer || [];
      var gtmLoaded = false;
      
      function loadGTM() {
        if (gtmLoaded) return;
        gtmLoaded = true;
        
        // Charger uniquement gtm.js - GTM gérera les autres scripts (gtag.js, etc.) via son conteneur
        var gtm = document.createElement('script');
        gtm.async = true;
        gtm.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-MR7JDNSD';
        document.head.appendChild(gtm);
      }
      
      // Charger GTM uniquement après interaction utilisateur (scroll, clic, ou après 10s pour les robots)
      var interactionEvents = ['scroll', 'click', 'keydown', 'touchstart', 'mousedown'];
      var hasInteracted = false;
      var loadGTMOnInteraction = function() {
        if (!hasInteracted) {
          hasInteracted = true;
          loadGTM();
          // Retirer les listeners après le premier chargement
          interactionEvents.forEach(function(event) {
            document.removeEventListener(event, loadGTMOnInteraction, { passive: true });
          });
        }
      };
      
      // Écouter les interactions utilisateur avec once:true pour ne charger qu'une fois
      interactionEvents.forEach(function(event) {
        document.addEventListener(event, loadGTMOnInteraction, { passive: true, once: true });
      });
      
      // Fallback : charger après 10 secondes si aucune interaction (pour les robots/crawlers)
      setTimeout(function() {
        if (!gtmLoaded) {
          loadGTM();
        }
      }, 10000);
    </script>
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MR7JDNSD"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    
    <div id="root">
      <!-- CSS CRITIQUE inline -->
      <style>
        *,*::before,*::after{box-sizing:border-box}
        body{margin:0;font-family:Geist,system-ui,-apple-system,sans-serif;-webkit-font-smoothing:antialiased}
        .min-h-screen{min-height:100vh}
        .flex{display:flex}
        .flex-col{flex-direction:column}
        .flex-1{flex:1 1 0%}
      </style>
    </div>
    <script type="module" src="/src/main.jsx"></script>

    <!-- Plausible Analytics - Chargé après le rendu initial pour éviter la variation de performance -->
    <script>
      // Charger Plausible après le rendu pour ne pas impacter le score de performance de manière variable
      if ('requestIdleCallback' in window) {
        requestIdleCallback(function() {
          var script = document.createElement('script');
          script.defer = true;
          script.setAttribute('data-domain', 'mynotary.io');
          script.src = 'https://plausible.io/js/script.js';
          document.head.appendChild(script);
        }, { timeout: 3000 });
      } else {
        setTimeout(function() {
          var script = document.createElement('script');
          script.defer = true;
          script.setAttribute('data-domain', 'mynotary.io');
          script.src = 'https://plausible.io/js/script.js';
          document.head.appendChild(script);
        }, 2000);
      }
    </script>

    <!-- Crisp Chat - chargé uniquement après interaction utilisateur pour éviter la variation -->
    <script type="text/javascript">
      window.$crisp=[];
      window.CRISP_WEBSITE_ID="fd0c2560-46ba-4da6-8979-47748ddf247a";
      var crispLoaded = false;
      
      function loadCrisp(){
        if (crispLoaded) return;
        crispLoaded = true;
        var d=document;
        var s=d.createElement("script");
        s.src="https://client.crisp.chat/l.js";
        s.async=1;
        d.getElementsByTagName("head")[0].appendChild(s);
      }
      
      // Charger Crisp uniquement après interaction utilisateur (comme GTM) pour éviter la variation
      var interactionEvents = ['scroll', 'click', 'keydown', 'touchstart', 'mousedown'];
      var hasInteracted = false;
      var loadCrispOnInteraction = function() {
        if (!hasInteracted) {
          hasInteracted = true;
          loadCrisp();
          interactionEvents.forEach(function(event) {
            document.removeEventListener(event, loadCrispOnInteraction, { passive: true });
          });
        }
      };
      
      interactionEvents.forEach(function(event) {
        document.addEventListener(event, loadCrispOnInteraction, { passive: true, once: true });
      });
      
      // Fallback : charger après 15 secondes si aucune interaction (plus tard que GTM pour ne pas bloquer)
      setTimeout(function() {
        if (!crispLoaded) {
          loadCrisp();
        }
      }, 15000);
    </script>
  </body>
</html>
